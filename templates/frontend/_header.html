<div class="top-header-bar navbar-fixed-top">
    <div class="container">
        <div class="logo-menu">
          <a href="/activity">
            <img width="108" height="30" src="/static/images/icons/logo.png" class="hide-div">
          </a>
            <a ng-click="openAside('left')" href="#">
                <img width="27" height="22" src="/static/images/icons/menu.png" class="show-div">
            </a>
        </div>
        <div style="float:right; display:inline-block; border-left:0px solid #ddd; padding:15px 0 6px 0; text-align:right; position:relative;">
            <span class="top-icons"><a href="#"><img width="100%" src="/static/images/icons/noti.png"></a></span>
            <span class="top-icons"><a href="#"><img width="100%" src="/static/images/icons/friendsx.png"></a></span>
            <span class="top-icons"><a href="#"><img width="100%" src="/static/images/icons/mess.png"></a></span>
            <span class="top-drop hide-div">
                <div class="dropdown navbar-right">
                    <span class="nav-profile-pix-img hide-div"><img width="100%" src="/static/images/people/guy-4.jpg"></span>
                    <a style="color:#fff; display:inline-block; vertical-align:top;" aria-expanded="false" role="button" data-toggle="dropdown" class="dropdown-toggle" href="#">
                      <!-- Put name here from context variable -->
                      Jome Akpoduado  <span class="caret-top"></span></a>
                    <ul aria-labelledby="dLabel" role="menu" class="dropdown-menu">
                        <li><a href="#">Profile</a></li>
                        <li><a href="#">Messages</a></li>
                        <li><a href="#">Settings</a></li>
                        <li class="divider"></li>
                        <li><a href="#">Logout</a></li>
                    </ul>
                </div>
             </span>

        </div>
        <!--search starts-->
        <div class="search-icon-xs">
            <div id="searchtext">
                
                    <input type="search" placeholder="Search for people" id="id-search-text">
                
            </div>
        </div>
        <!--search form ends-->
    </div>
    <div style="clear:both;"></div>
</div>

<!-- Implementation of search -->
<script type="text/javascript">
    var search_text = $('#id-search-text').val();
    console.log(search_text);
    /*$('#id-search-text').keypress(function (e) {
        e.preventDefault();
    if (e.which == 13) {
        $('form#id-search-text').submit();
            
        }
    });

    $(function (){
        $('#id-search-text').change(function (){
          console.log($('#id-search-text').val());

        });       

    });*/

    //works

    // search for first name for now
    var uri = "http://192.168.10.20:9200/info/users/_search?q=firstname:";
/*
    $("#id-search-text").keypress(function(e){
        var query = $('#id-search-text').val();

        if (e.which == 13) {
            console.log('The text changed ' + $('#id-search-text').val());
             $.ajax({
                url: "/search/"+ query,
                type: 'GET',
                success: function (result) {
                    console.log(result); 
                    
                }
            });  
        }
    });
*/

    /*$("#id-search-text").keypress(function(e){
        var query = $('#id-search-text').val();
        //console.log('The text typed ' + uri+ query);

        if (query.length > 5) {
            $.ajax({
                url: uri + query,
                type: 'GET',
                success: function (result) {
                    console.log(result);
                    
                }
            });  

        }
        

        if (e.which == 13) {
            console.log('The text changed ' + $('#id-search-text').val());
             $.ajax({
                url: uri + query,
                type: 'GET',
                success: function (result) {
                    console.log(result); 
                    console.log('Hits object: ')
                    console.log(result['hits']['hits']);
                    var hits = result['hits']['hits'];
                    for (i=0; i < hits.length; i++ ) {
                        var person = hits[i]['_source'];
                        console.log(person['username'], person['firstname'], person['lastname']);
                        

                    }
                    
                }
            });  
        }
    });
*/
    $("#id-search-text").keypress(function(e){
        var query = $('#id-search-text').val();
        uri = 'search/' + query;
        //console.log('The text typed ' + uri+ query);

        if (query.length >= 3) {
            console.log('search-->');
            $.ajax({
                url: uri ,
                type: 'GET',
                success: function (result) {
                    console.log('Calling search from keypress');
                    
                }
            });  

        }
    });
    // works
    $("#id-search-text").change(function(){
        var query = $('#id-search-text').val();
        uri = 'search/' + query;
        //uri = 'test';
        console.log('The text changed ** ' + query);
         $.ajax({
                //url: 'search/'+ query,
                url: uri,
                type: 'GET',
                success: function (result) {
                    console.log('Calling search method from change...');
                    
                },
                error: function() {
                    console.log('An error occurred');
                }
            });  

    });


</script>